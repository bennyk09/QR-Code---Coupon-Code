<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Scanner - View Coupon</title>
</head>
<body>
</body><script>
    const params = new URLSearchParams(window.location.search);
    const coupon = params.get("coupon");

    // Display coupon if exists in URL
    if (coupon) {
        let display = document.createElement("h1");
        display.textContent = "Your Coupon Code: " + coupon;
        display.style.textAlign = "center";
        display.style.marginTop = "40px";
        display.style.fontFamily = "Arial, Helvetica, sans-serif";
        document.body.appendChild(display);

        // Claim button
        let claimBtn = document.createElement("button");
        claimBtn.textContent = "CLAIM";
        claimBtn.style.display = "block";
        claimBtn.style.margin = "20px auto";
        claimBtn.style.padding = "10px 30px";
        claimBtn.style.fontSize = "18px";
        claimBtn.onclick = () => saveCoupon(coupon);
        document.body.appendChild(claimBtn);

        // Leave button
        let leaveBtn = document.createElement("button");
        leaveBtn.textContent = "LEAVE";
        leaveBtn.style.display = "block";
        leaveBtn.style.margin = "10px auto";
        leaveBtn.style.padding = "10px 30px";
        leaveBtn.style.fontSize = "18px";
        leaveBtn.onclick = () => window.location.href = location.origin + location.pathname;
        document.body.appendChild(leaveBtn);
    }

    // Function to save coupon
    function saveCoupon(code) {
        let saved = JSON.parse(localStorage.getItem("claimedCoupons") || "[]");
        if (!saved.includes(code)) {
            saved.push(code);
            localStorage.setItem("claimedCoupons", JSON.stringify(saved));
        }
        showCoupons();
        alert("Coupon claimed!");
    }

    // Show claimed coupons
    function showCoupons() {
        let saved = JSON.parse(localStorage.getItem("claimedCoupons") || "[]");

        // Create container if not exists
        let section = document.getElementById("couponSection");
        if (!section) {
            section = document.createElement("div");
            section.id = "couponSection";
            section.style.textAlign = "center";
            section.style.marginTop = "60px";
            document.body.appendChild(section);
        }

        // Update view
        section.innerHTML = "<h2>Saved Coupons</h2>";
        if (saved.length === 0) {
            section.innerHTML += "<p>No coupons saved</p>";
            return;
        }

        saved.forEach((code, index) => {
            let row = document.createElement("div");
            row.style.margin = "10px";

            let text = document.createElement("span");
            text.textContent = code;
            text.style.fontSize = "20px";
            text.style.marginRight = "20px";
            row.appendChild(text);

            let useBtn = document.createElement("button");
            useBtn.textContent = "USE";
            useBtn.style.padding = "5px 15px";
            useBtn.onclick = () => useCoupon(index);
            row.appendChild(useBtn);

            section.appendChild(row);
        });
    }

    // Use (remove) a coupon
    function useCoupon(index) {
        let saved = JSON.parse(localStorage.getItem("claimedCoupons") || "[]");
        saved.splice(index, 1);
        localStorage.setItem("claimedCoupons", JSON.stringify(saved));
        showCoupons();
        alert("Coupon used!");
    }

    // Always show saved coupons section
    showCoupons();
</script>


</html>
